# Predicci-n-del-Caudal-para-la-Planificaci-n-Hidroclimatol-gica
## Contexto
### La precisa comprensión y predicción de los caudales son fundamentales para la gestión sostenible de los recursos hídricos y la toma de decisiones en la planificación hidroclimatológica. El objetivo de este estudio es desarrollar un modelo de deep learning que permita generar predicciones sobre el incremento en las fluctuaciones del caudal del río, al mismo tiempo se pretende integrar una solución que permita mejorar la gestión de riesgos hidro climatológicos y que contribuya en la disminución de las pérdidas materiales, económicas y de vidas humanas en la región.
### Según datos Nature Comunications, [1] las inundaciones provocadas por fuertes lluvias y marejadas ciclónicas afectan a millones de personas cada año y causan miles de millones de dólares en daños a viviendas, infraestructuras y economías.
### En Ecuador las pérdidas económicas estimadas para los productores de arroz, banano y cacao ascendieron a 180 millones de dólares. El Ministerio de Finanzas calcula que las pérdidas suman 200 millones de dólares, incluyendo el invierno y los destrozos causados por el terremoto del 18 de marzo.
### Desde enero hasta marzo de 2023, se han reportado 18 personas fallecidas, más de 14.000 personas afectadas, 42 viviendas destruidas y 7.975 hectáreas de cultivos afectados, Primicias, abril 2023. [2]
### Así pues, nuestro primer abordaje toma los datos de una estación hidrométrica del río Magdalena, uno de los más importante para Colombia y los une las series de tiempo de los índices climáticos del Niño y la Niña, para refinar las predicciones y tener una base más sólida para los sistemas de alerta temprana y planes de contención.
## Sobre los datos
### Los datos fueron recolectados desde el sitio web [3], el cual recopila datos Hidrometeorológicos de Colombia desde el 1 de enero 1950 hasta la fecha actual 24/02/2024, dando un total de 26.788 datos para el estudio. Entre algunas de las características que tiene cada dato, tenemos: código de estación, nombre de estación, longitud, latitud, altitud, categoría, entidad, área operativa, departamento, fecha, valor, grado, calificador, etc.
### Por otro lado, como ya se ha mencionado, nuestra intención es tener en cuenta otros factores e indicadores que las investigaciones muestran que influyen directamente en la dinámica de los ríos, pero que normalmente no son tenidos en cuenta para la predicción del caudal. La información de estos índices climáticos sobre el fenómeno del Niño y la Niña los obtenemos de la página oficial de la NOAA (National Oceanic and Atmospheric Administration) [4].
## Inputs & Outputs
### Al realizar el análisis respectivo de los datos, se llegó a la conclusión de que las características que nos proporcionaban más valor al modelo de predicción fueron “Valor” , que representa el caudal del río y “Fecha”. Además se fusiona con la serie de tiempo de los índices climáticos, es decir, nuestro modelo recibe una serie de tiempo multivariada.
### La primera versión del modelo va a entregar una sola predicción del caudal, pero la idea del proyecto es obtener toda una serie de números, es decir, estas redes neuronales nos permiten hacer predicciones para varios pasos de tiempo, el cual es el objetivo a seguir para poder tomar medidas preventivas.
## Modelaje
### Se propone un modelo de redes neuronales tipo LSTM (Long short term memory). Este modelo es una mejora de las redes neuronales recurrentes tradicionales dado que están equipadas con una estructura de celdas de memoria especializada que les permite aprender dependencias a largo plazo, además de que nos abren la posibilidad de trabajar con series de tiempo multivariadas. El modelo va a predecir números continuos y se evaluará su desempeño con RMSE.
### Hoy en día gracias a los avances tecnológicos se utilizan mucho las redes neuronales para la predicción de datos entre las principales tenemos: redes neuronales convolucionales, redes neuronales recurrentes y memoria a largo plazo (LSTM). [5] En donde podemos definir que un modelo aleatorio sería una red neuronal recurrente, pero estas tienen dificultades para aprender dependencias a largo plazo debido al problema del desvanecimiento del gradiente.
## Métricas Auxiliares
### Definimos la métrica de RSME para validar si nuestro modelo es factible o no, pudiendo aplicar otras métricas para validar nuestro problema de regresión, pueden ser: MSE (Mean square error), MAE (Mean Absolute Error), RMSLE (Root Mean Square Logarithmic Error). En donde cabe recalcar que se podría hacer todas estas pruebas para validar mejor el modelo propuesto.
## SOTA
### En [6] se presenta una comparativa de varios modelos de redes neuronales para la predicción de los caudales entre ellos se tiene, la red neuronal feedforward de tipo perceptrón multicapa, la red neuronal de Función de Base Radial y la red neuronal feedforward en cascada. Donde el mejor resultado se obtuvo en el feedforward en cascada, con un error de predicción de 2.3 % en los primeros 30 minutos y un error de 21,3 % dentro de las primeras 12 horas. Llegando a la conclusión que el sistema solo proveía el comportamiento solo de periodos de tiempos muy cortos.
### En [7] se realiza un análisis de series de volúmenes anuales en el río Magdalena donde usan ARIMA como modelo, en este artículo se realizaron varias pruebas con diferentes parámetros a la hora de entrenar. Donde los resultados de la simulación con el modelo ARIMA, comparados con los datos observados, muestran un ajuste adecuado de los valores mínimos y máximos. Esto permite concluir que, aunque estos modelos no simulan el comportamiento exacto en el tiempo, son una buena herramienta para aproximar eventos mínimos y máximos.
### En [8] se propone un modelado estadístico del caudal mensual bajo la Cuenca del Plata. La predicción presentó varias singularidades debido a que esta proyección fue para los 32 meses siguientes, de notando que no se tomó en cuenta corridas crecientes inesperadas al no poseer muchos datos de varios años. Se concluyó que el estudio si es óptimo para una estimación de un primer año y medio y mejora de modelo con más datos con ayuda de otras estaciones de medición.
### EN RESUMEN: En el proyecto planteado en esta investigación se pretende una predicción de un tiempo más amplio, dando un valor adicional a los modelos ya existentes, ya que con ayuda de la LSTM se toma en cuenta la memoria a largo plazo y no solo los datos actuales que se obtienen del caudal, además de tener la posibilidad de incluir otras variables que nos van a permitir refinar las predicciones.

## Bibliografías
### [1]Flood exposure and poverty in 188 countries. Jun Rentschler, Melda Salhab & Bramka Arga Jafino. Nature Communications volume 13, Article number: 3527 (2022). https://www.nature.com/articles/s41467-022-30727-4
### [2]https://www.primicias.ec/noticias/economia/invierno-inundaciones-perdidas-arroz-cacao-banano/
### [3] http://dhime.ideam.gov.co/atencionciudadano/
### [4] https://psl.noaa.gov/gcos_wgsp/Timeseries/Nino34/
### [5] S. Song, S. Geng and Y. Wang, "Long Time Series Prediction of Meteorological Data Based on Improved Autoformer Model," 2023 2nd International Conference on Artificial Intelligence and Intelligent Information Processing (AIIIP), Hangzhou, China, 2023, pp. 175-179, doi: 10.1109/AIIIP61647.2023.00039.
### [6] Niklitschek, Diego & Ossandón Álvarez, Álvaro. (2019). Metodologías para predicción de caudales medios diarios utilizando un modelo hidrológico de derretimiento de nieve, y transformación de derretimiento en escorrentía aplicado en la cuenca del Río Juncal.
### [7] Gloria Amaris, Humberto Ávila, Thomas Guerro (2017). Aplicación de modelo ARIMA para el análisis de series de volúmenes anuales en el río Magdalena. https://www.redalyc.org/journal/2570/257051186008/html/
### [8] Meis, Melanie, & Llano, María Paul. (2018). Modelado estadístico del caudal mensual en la baja Cuenca del Plata. Meteorologica, 43(2), 63-77. Recuperado en 25 de febrero de 2024, de http://www.scielo.org.ar/scielo.php?script=sci_arttext&pid=S1850-468X2018000200004&lng=es&tlng=es.
